# 实验 4A：使用数据存储

虽然数据科学家普遍使用本地文件系统上的数据，但在企业环境中，将数据存储在多个数据科学家可以访问的中心位置可能效率更高。在本实验中，你要将数据存储在云中，并使用 Azure 机器学习*数据存储*访问该数据。

## 开始前

在开始本实验之前，请确保你已完成[实验 1A](Lab01A.md) 和[实验 1B](Lab01B.md)，其中包括创建 Azure 机器学习工作区和本实验中使用的其他资源的任务。

## 任务 1：创建 Azure 存储容器
你可以在 Azure 机器学习中使用多种 Azure 数据源。在本实验中，你将创建一个包含 blob 容器的 Azure 存储帐户。

1. 登录 [Azure 门户](https://portal.azure.com)，并打开包含 Azure 机器学习工作区的资源组。请注意，此资源组已经包含使用你的工作区创建的 Azure 存储帐户。

    >**注意**：使用你的工作区创建的存储帐户将由服务用于存储配置数据、笔记本、注册的模型等。你也可以用它存储用于试验和模型训练的数据，但是在许多情况下，最好单独管理此数据。

2. 为资源组添加具有以下设置的新**存储帐户**：

    - **存储帐户名称**：唯一名称。
    - **位置**：与工作区的位置相同
    - **性能**：标准
    - **帐户类型**：StorageV2（常规用途 v2）
    - **复制**：本地冗余存储 (LRS)
    - **访问层（默认）**：热
    - 使用默认设置进行网络连接

3. 等待存储帐户创建完毕，然后转到门户中的资源。
4. 打开存储帐户的**“容器”**页面，并添加具有以下设置的容器：

    - **名称**：aml-data
    - **公共访问级别**：专用（不允许匿名访问）

5. 添加容器后，查看存储帐户的**“访问密钥”**页面，并将 **key1** 复制到剪贴板，你在下一个任务中将需要此密钥。

## 任务 2：注册 Azure 机器学习数据存储

现在，你已创建存储容器，可以将其注册为 Azure 机器学习工作区中的数据存储。

1. 在 [Azure 机器学习工作室](https://ml.azure.com)中，查看工作区的**“数据存储”**页面。将列出预定义的数据存储。
2. 创建具有以下设置的新数据存储：
    - **数据储存名称**：aml_data
    - **数据储存类型**：Azure Blob 存储
    - **帐户选择方式**：来自 Azure 订阅
    - **订阅 ID**：*你的 Azure 订阅*
    - **存储帐户**：*你在上一个任务中创建的存储帐户*
    - **Blob 容器**：aml-data
    - **身份验证类型**：帐户密钥
    - **帐户密钥**：*粘贴你在上一个任务中复制的密钥*
3. 添加数据存储后，验证其是否在**“数据存储”**页面上列出。

## 任务 3：使用 Azure 机器学习 SDK 访问数据存储

在此任务中，你将使用 Azure 机器学习 SDK 向数据存储上传数据以及从数据存储下载数据。

1. 在 [Azure 机器学习工作室](https://ml.azure.com)中，查看工作区的**“计算”**页面，并在**“计算实例”**选项卡上启动计算实例。
2. 当计算实例运行时，在浏览器中刷新 Azure 机器学习工作室网页，确保身份验证会话没有过期。然后单击 **Jupyter** 链接以在新的浏览器选项卡中打开 Jupyter 主页。
3. 在 Jupyter 主页的 **Users/DP100** 文件夹中，打开 **04A - Working with Datastores.ipynb** 笔记本。然后阅读笔记本中的笔记，依次运行每个代码单元。
4. 笔记本中的代码运行完毕后，在**“文件”**菜单上单击**“关闭并停止”**以关闭它及其 Python 内核。然后关闭所有 Jupyter 浏览器选项卡。
5. 在 Azure 机器学习工作室中的**“计算”**页面上，选择计算实例，然后单击**“停止”**以将其关闭。
